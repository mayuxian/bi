(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2ed66503"],{"0481":function(e,t,n){"use strict";var a=n("23e7"),i=n("a2bf"),r=n("7b0b"),o=n("50c4"),s=n("a691"),l=n("65f0");a({target:"Array",proto:!0},{flat:function(){var e=arguments.length?arguments[0]:void 0,t=r(this),n=o(t.length),a=l(t,0);return a.length=i(a,t,t,n,0,void 0===e?1:s(e)),a}})},"0cb6":function(e,t,n){},1166:function(e,t,n){"use strict";n("f387")},1276:function(e,t,n){"use strict";var a=n("d784"),i=n("44e7"),r=n("825a"),o=n("1d80"),s=n("4840"),l=n("8aa5"),c=n("50c4"),u=n("14c3"),d=n("9263"),f=n("d039"),p=[].push,h=Math.min,v=4294967295,g=!f((function(){return!RegExp(v,"y")}));a("split",2,(function(e,t,n){var a;return a="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,n){var a=String(o(this)),r=void 0===n?v:n>>>0;if(0===r)return[];if(void 0===e)return[a];if(!i(e))return t.call(a,e,r);var s,l,c,u=[],f=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),h=0,g=new RegExp(e.source,f+"g");while(s=d.call(g,a)){if(l=g.lastIndex,l>h&&(u.push(a.slice(h,s.index)),s.length>1&&s.index<a.length&&p.apply(u,s.slice(1)),c=s[0].length,h=l,u.length>=r))break;g.lastIndex===s.index&&g.lastIndex++}return h===a.length?!c&&g.test("")||u.push(""):u.push(a.slice(h)),u.length>r?u.slice(0,r):u}:"0".split(void 0,0).length?function(e,n){return void 0===e&&0===n?[]:t.call(this,e,n)}:t,[function(t,n){var i=o(this),r=void 0==t?void 0:t[e];return void 0!==r?r.call(t,i,n):a.call(String(i),t,n)},function(e,i){var o=n(a,e,this,i,a!==t);if(o.done)return o.value;var d=r(e),f=String(this),p=s(d,RegExp),m=d.unicode,b=(d.ignoreCase?"i":"")+(d.multiline?"m":"")+(d.unicode?"u":"")+(g?"y":"g"),y=new p(g?d:"^(?:"+d.source+")",b),x=void 0===i?v:i>>>0;if(0===x)return[];if(0===f.length)return null===u(y,f)?[f]:[];var S=0,w=0,O=[];while(w<f.length){y.lastIndex=g?w:0;var _,C=u(y,g?f:f.slice(w));if(null===C||(_=h(c(y.lastIndex+(g?0:w)),f.length))===S)w=l(f,w,m);else{if(O.push(f.slice(S,w)),O.length===x)return O;for(var I=1;I<=C.length-1;I++)if(O.push(C[I]),O.length===x)return O;w=S=_}}return O.push(f.slice(S)),O}]}),!g)},"129f":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},"2e9e":function(e,t,n){var a=n("ded3").default,i=n("4082").default;n("99af"),e.exports={functional:!0,render:function(e,t){var n=t._c,r=(t._v,t.data),o=t.children,s=void 0===o?[]:o,l=r.class,c=r.staticClass,u=r.style,d=r.staticStyle,f=r.attrs,p=void 0===f?{}:f,h=i(r,["class","staticClass","style","staticStyle","attrs"]);return n("svg",a({class:[l,c],style:[u,d],attrs:Object.assign({xmlns:"http://www.w3.org/2000/svg"},p)},h),s.concat([n("defs",[n("pattern",{attrs:{id:"a",width:"10",height:"10",patternUnits:"userSpaceOnUse"}},[n("path",{attrs:{d:"M10 0H0v10",fill:"none",stroke:"#2c3e5022"}})]),n("pattern",{attrs:{id:"b",width:"100",height:"100",patternUnits:"userSpaceOnUse"}},[n("path",{attrs:{fill:"url(#a)",d:"M0 0h100v100H0z"}}),n("path",{attrs:{d:"M100 0H0v100",fill:"none",stroke:"#2c3e5022","stroke-width":"1.5"}})])]),n("rect",{attrs:{width:"100%",height:"100%",fill:"url(#b)"}})]))}}},"3a7f":function(e,t,n){"use strict";n("9963")},"3a95":function(e,t,n){},"3c35c":function(e,t,n){"use strict";n("3a95")},4082:function(e,t,n){n("a4d3");var a=n("f0e4");function i(e,t){if(null==e)return{};var n,i,r=a(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}e.exports=i,e.exports["default"]=e.exports,e.exports.__esModule=!0},"466d":function(e,t,n){"use strict";var a=n("d784"),i=n("825a"),r=n("50c4"),o=n("1d80"),s=n("8aa5"),l=n("14c3");a("match",1,(function(e,t,n){return[function(t){var n=o(this),a=void 0==t?void 0:t[e];return void 0!==a?a.call(t,n):new RegExp(t)[e](String(n))},function(e){var a=n(t,e,this);if(a.done)return a.value;var o=i(e),c=String(this);if(!o.global)return l(o,c);var u=o.unicode;o.lastIndex=0;var d,f=[],p=0;while(null!==(d=l(o,c))){var h=String(d[0]);f[p]=h,""===h&&(o.lastIndex=s(c,r(o.lastIndex),u)),p++}return 0===p?null:f}]}))},"4d63":function(e,t,n){var a=n("83ab"),i=n("da84"),r=n("94ca"),o=n("7156"),s=n("9bf2").f,l=n("241c").f,c=n("44e7"),u=n("ad6d"),d=n("9f7f"),f=n("6eeb"),p=n("d039"),h=n("69f3").set,v=n("2626"),g=n("b622"),m=g("match"),b=i.RegExp,y=b.prototype,x=/a/g,S=/a/g,w=new b(x)!==x,O=d.UNSUPPORTED_Y,_=a&&r("RegExp",!w||O||p((function(){return S[m]=!1,b(x)!=x||b(S)==S||"/a/i"!=b(x,"i")})));if(_){var C=function(e,t){var n,a=this instanceof C,i=c(e),r=void 0===t;if(!a&&i&&e.constructor===C&&r)return e;w?i&&!r&&(e=e.source):e instanceof C&&(r&&(t=u.call(e)),e=e.source),O&&(n=!!t&&t.indexOf("y")>-1,n&&(t=t.replace(/y/g,"")));var s=o(w?new b(e,t):b(e,t),a?this:y,C);return O&&n&&h(s,{sticky:n}),s},I=function(e){e in C||s(C,e,{configurable:!0,get:function(){return b[e]},set:function(t){b[e]=t}})},D=l(b),E=0;while(D.length>E)I(D[E++]);y.constructor=C,C.prototype=y,f(i,"RegExp",C)}v("RegExp")},5444:function(e,t,n){"use strict";n("b2d6")},"5ae0":function(e,t,n){"use strict";n("0cb6")},7156:function(e,t,n){var a=n("861d"),i=n("d2bb");e.exports=function(e,t,n){var r,o;return i&&"function"==typeof(r=t.constructor)&&r!==n&&a(o=r.prototype)&&o!==n.prototype&&i(e,o),e}},"794f":function(e,t,n){},8110:function(e,t,n){},"841c":function(e,t,n){"use strict";var a=n("d784"),i=n("825a"),r=n("1d80"),o=n("129f"),s=n("14c3");a("search",1,(function(e,t,n){return[function(t){var n=r(this),a=void 0==t?void 0:t[e];return void 0!==a?a.call(t,n):new RegExp(t)[e](String(n))},function(e){var a=n(t,e,this);if(a.done)return a.value;var r=i(e),l=String(this),c=r.lastIndex;o(c,0)||(r.lastIndex=0);var u=s(r,l);return o(r.lastIndex,c)||(r.lastIndex=c),null===u?-1:u.index}]}))},8933:function(e,t,n){},9523:function(e,t){function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}e.exports=n,e.exports["default"]=e.exports,e.exports.__esModule=!0},9963:function(e,t,n){},a15b:function(e,t,n){"use strict";var a=n("23e7"),i=n("44ad"),r=n("fc6a"),o=n("a640"),s=[].join,l=i!=Object,c=o("join",",");a({target:"Array",proto:!0,forced:l||!c},{join:function(e){return s.call(r(this),void 0===e?",":e)}})},a2bf:function(e,t,n){"use strict";var a=n("e8b5"),i=n("50c4"),r=n("0366"),o=function(e,t,n,s,l,c,u,d){var f,p=l,h=0,v=!!u&&r(u,d,3);while(h<s){if(h in n){if(f=v?v(n[h],h,t):n[h],c>0&&a(f))p=o(e,t,f,i(f.length),p,c-1)-1;else{if(p>=9007199254740991)throw TypeError("Exceed the acceptable array length");e[p]=f}p++}h++}return p};e.exports=o},a9e3:function(e,t,n){"use strict";var a=n("83ab"),i=n("da84"),r=n("94ca"),o=n("6eeb"),s=n("5135"),l=n("c6b6"),c=n("7156"),u=n("c04e"),d=n("d039"),f=n("7c73"),p=n("241c").f,h=n("06cf").f,v=n("9bf2").f,g=n("58a8").trim,m="Number",b=i[m],y=b.prototype,x=l(f(y))==m,S=function(e){var t,n,a,i,r,o,s,l,c=u(e,!1);if("string"==typeof c&&c.length>2)if(c=g(c),t=c.charCodeAt(0),43===t||45===t){if(n=c.charCodeAt(2),88===n||120===n)return NaN}else if(48===t){switch(c.charCodeAt(1)){case 66:case 98:a=2,i=49;break;case 79:case 111:a=8,i=55;break;default:return+c}for(r=c.slice(2),o=r.length,s=0;s<o;s++)if(l=r.charCodeAt(s),l<48||l>i)return NaN;return parseInt(r,a)}return+c};if(r(m,!b(" 0o1")||!b("0b1")||b("+0x1"))){for(var w,O=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof O&&(x?d((function(){y.valueOf.call(n)})):l(n)!=m)?c(new b(S(t)),n,O):S(t)},_=a?p(b):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),C=0;_.length>C;C++)s(b,w=_[C])&&!s(O,w)&&v(O,w,h(b,w));O.prototype=y,y.constructor=O,o(i,m,O)}},af8c:function(e,t,n){},b2d6:function(e,t,n){},baf4:function(e,t,n){"use strict";n("794f")},bc09:function(e,t,n){"use strict";n("d9b1")},c300:function(e,t,n){"use strict";n("af8c")},c45a:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));n("a4d3"),n("e01a"),n("d3b7"),n("d28b"),n("3ca3"),n("ddb0");function a(e){return a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}n("d4ec"),n("bee2"),n("99af"),n("a15b"),n("159b"),n("b64b"),n("841c"),n("ac1f"),n("4d63"),n("25f0"),n("466d");function i(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];for(var r in null!==e&&"object"===a(e)||(e=t.constructor===Array?[]:{}),t)"undefined"!==typeof t[r]&&t.hasOwnProperty(r)&&(null!==t[r]&&"object"===a(t[r])&&n?e[r]=i(e[r],t[r],n):e[r]=t[r]);return e}function r(e){return i(null,e,!0)}n("1276");function o(){for(var e=[],t="0123456789abcdef",n=0;n<36;n++)e[n]=t.substr(Math.floor(16*Math.random()),1);e[14]="4",e[19]=t.substr(3&e[19]|8,1),e[8]=e[13]=e[18]=e[23]="";var a=e.join("");return a}},c77f:function(e,t,n){"use strict";n("e9d0")},d9b1:function(e,t,n){},ded3:function(e,t,n){n("b64b"),n("a4d3"),n("4de4"),n("e439"),n("159b"),n("dbb4");var a=n("9523");function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}e.exports=r,e.exports["default"]=e.exports,e.exports.__esModule=!0},e4be:function(e,t,n){"use strict";n("8110")},e6d8:function(e,t,n){"use strict";n("8933")},e9d0:function(e,t,n){},ef11:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=this,n=t.$createElement,a=t._self._c||n;return a("el-container",{staticClass:"layout-main"},[a("el-menu",{attrs:{"default-active":"2",collapse:!0},on:{select:function(t){return e.selectMenuIndex=t}}},[a("el-menu-item",{attrs:{index:"1"}},[a("div",{staticStyle:{"text-align":"center"}},[a("i",{staticClass:"el-icon-menu"}),a("div",[t._v("项目")])]),a("span",{attrs:{slot:"title"},slot:"title"},[t._v("项目")])]),a("el-menu-item",{attrs:{index:"2"}},[a("div",{staticStyle:{"text-align":"center"}},[a("i",{staticClass:"el-icon-menu"}),a("div",[t._v("数据源")])]),a("span",{attrs:{slot:"title"},slot:"title"},[t._v("数据源")])]),a("el-menu-item",{attrs:{index:"3"}},[a("div",{staticStyle:{"text-align":"center"}},[a("i",{staticClass:"el-icon-menu"}),a("div",[t._v("组件库")])]),a("span",{attrs:{slot:"title"},slot:"title"},[t._v("组件库")])])],1),a("el-aside",{staticClass:"layout-store",attrs:{width:"220px"}},[a("chart-store",{directives:[{name:"show",rawName:"v-show",value:"3"===t.selectMenuIndex,expression:"selectMenuIndex==='3'"}]}),a("data-source",{directives:[{name:"show",rawName:"v-show",value:"2"===t.selectMenuIndex,expression:"selectMenuIndex==='2'"}]})],1),a("el-main",{directives:[{name:"show",rawName:"v-show",value:!t.dsUnionVisible,expression:"!dsUnionVisible"}],staticClass:"main-container"},[a("tags-view"),a("app-main")],1),a("el-aside",{directives:[{name:"show",rawName:"v-show",value:!t.dsUnionVisible,expression:"!dsUnionVisible"}],staticClass:"layout-props",attrs:{width:"300px"}},[a("props-sidebar",{on:{"fetch-data":t.fetchData}})],1),t.dsUnionVisible?a("el-main",{staticClass:"ds-union-container"},[a("data-source-union")],1):t._e()],1)},i=[],r=n("1da1"),o=n("5530"),s=(n("96cf"),n("d3b7"),n("3ca3"),n("ddb0"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",{staticClass:"app-main"},[n("transition",{attrs:{name:"fade-transform",mode:"out-in"}},[n("keep-alive",[e._l(e.pageList,(function(t){return[e.switchPage(t)?n("page-board",{key:t.id,attrs:{id:t.id,"page-view":t.pageView}}):e._e()]}))],2)],1)],1)}),l=[],c=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",[n("binding-panel",{attrs:{binding:e.activeElement.binding},on:{change:e.onBindingChange}}),n("div",{ref:"pageCanvas",staticClass:"page-layout page-layout-grid",on:{dragenter:function(t){return t.stopPropagation(),t.preventDefault(),e.onDragEnter(t)},dragover:function(t){return t.stopPropagation(),t.preventDefault(),e.onDragOver(t)},dragleave:function(t){return t.stopPropagation(),t.preventDefault(),e.onDragLeave(t)},drop:function(t){return t.stopPropagation(),t.preventDefault(),e.onDrop(t)},contextmenu:function(t){return t.stopPropagation(),t.preventDefault(),e.onShowPageMenu(t)}}},[n("el-scrollbar",{staticClass:"center-scrollbar"},[e._e(),e._l(e.pageComponents,(function(t,a){return n("vue-draggable-resizable",{key:t.eleId+a,attrs:{active:t.active,scale:e.layoutScale,x:t.layout.x,y:t.layout.y,w:t.layout.w,h:t.layout.h,"min-width":40,"class-name-dragging":"dragging-class","class-name-resizing":"resizing-class","class-name-active":"active-class"},on:{"update:active":function(n){return e.$set(t,"active",n)},activated:function(n){return e.onEleActivated(t)},deactivated:function(n){return e.onEleDeactivated(t)}}},["el-table"===t.name?n("el-table",{style:t.props.style,attrs:{data:t.props.data}},e._l(t.children,(function(t){return n("el-table-column",e._b({key:t.prop},"el-table-column",t,!1))})),1):n(t.name,e._b({key:t.eleId,ref:"chart"+t.eleId,refInFor:!0,tag:"component",on:{contextmenu:function(n){return n.preventDefault(),n.stopPropagation(),e.onShowEleMenu(n,t)}}},"component",t.attrs,!1))],1)})),n("div",{directives:[{name:"show",rawName:"v-show",value:!e.pageComponents.length,expression:"!pageComponents.length"}],staticClass:"empty-info"},[e._v("拖入或点选组件进行设计")])],2)],1)],1)},u=[],d=n("15fd"),f=(n("a9e3"),n("25f0"),n("1276"),n("ac1f"),n("b0c0"),n("2e9e")),p=n.n(f),h=n("c45a"),v=n("5880");function g(e,t,n,a){var i,r=!1,o=0;function s(){i&&clearTimeout(i)}function l(){s(),r=!0}function c(){for(var l=arguments.length,c=new Array(l),u=0;u<l;u++)c[u]=arguments[u];var d=this,f=Date.now()-o;function p(){o=Date.now(),n.apply(d,c)}function h(){i=void 0}r||(a&&!i&&p(),s(),void 0===a&&f>e?p():!0!==t&&(i=setTimeout(a?h:p,void 0===a?e-f:e)))}return"boolean"!==typeof t&&(a=n,n=t,t=void 0),c.cancel=l,c}function m(e,t,n){return void 0===n?g(e,t,!1):g(e,n,!1!==t)}n("159b");var b="lego-",y=b+"page-data-Id_",x=b+"page-list-data";function S(e,t){t&&e&&window.localStorage.setItem(y+e,JSON.stringify(t))}function w(e){var t=window.localStorage.getItem(y+e);return t?JSON.parse(t):null}function O(){var e=window.localStorage.getItem(x)||[],t=[];return e.forEach((function(e){if(e.opening){var n=w(n.id);t.push(n)}})),t}n("5319");var _={_id:"VIEWPORT",nodeType:1},C=!1,I=(window.navigator.userAgent||"").toLowerCase(),D=-1!==I.indexOf("msie 6"),E=function(e){return e?"string"===typeof e?window.document.querySelector(e):e:null},j=function(e,t){var n,a=E(e),i=window.getComputedStyle||(null===(n=window.document.defaultView)||void 0===n?void 0:n.getComputedStyle),r=a.currentStyle||i(a,null);return r&&r[t]},T=function(e,t,n){var a=E(e);a.style[t]=n},k=function(e){var t,n,a,i,r=null===(t=j(e,"padding-left"))||void 0===t?void 0:t.replace("px",""),o=null===(n=j(e,"padding-right"))||void 0===n?void 0:n.replace("px",""),s=null===(a=j(e,"border-Width"))||void 0===a?void 0:a.replace("px",""),l=null===(i=j(e,"width"))||void 0===i?void 0:i.replace("px","");return"border-box"===j(e,"border-box")?l||"0px":Number(r||0)+Number(o||0)+Number(s||0)+Number(l||0)+"px"},P=function(e){var t,n,a,i,r=null===(t=j(e,"padding-top"))||void 0===t?void 0:t.replace("px",""),o=null===(n=j(e,"padding-bottom"))||void 0===n?void 0:n.replace("px",""),s=null===(a=j(e,"border-Width"))||void 0===a?void 0:a.replace("px",""),l=null===(i=j(e,"height"))||void 0===i?void 0:i.replace("px","");return"border-box"===j(e,"border-box")?l||"0px":Number(r||0)+Number(o||0)+Number(s||0)+Number(l||0)+"px"},A={};function N(e){e=V(e)||{},e.nodeType&&(e={element:e});var t=V(e.element)||_;if(1!==t.nodeType)throw new Error("posObject.element is invalid.");var n={element:t,x:e.x||0,y:e.y||0},a=t===_||"VIEWPORT"===t._id;return n.offset=function(){return C?{left:0,top:0}:a?{left:window.document.body.scrollLeft,top:window.document.body.scrollTop}:F(t)},n.size=function(){var e=a?window:t;return{width:k(e),height:P(e)}},n}function L(e){e.x=M(e.x,e,"width"),e.y=M(e.y,e,"height")}function M(e,t,n){if(e+="",e=e.replace(/px/gi,""),/\D/.test(e)&&(e=e.replace(/(?:top|left)/gi,"0%").replace(/center/gi,"50%").replace(/(?:bottom|right)/gi,"100%")),-1!==e.indexOf("%")&&(e=e.replace(/(\d+(?:\.\d+)?)%/gi,(function(e,a){return t.size()[n]*(a/100)}))),/[+\-*/]/.test(e))try{e=new Function("return "+e)()}catch(a){throw new Error("Invalid position value: "+e)}return R(e)}function $(e){var t,n=e.offsetParent;return n===document.documentElement&&(n=document.body),D&&T(n,"zoom",1),t=n===document.body&&"static"===j(n,"position")?{top:0,left:0}:F(n),t.top+=R(j(n,"border-top-width")),t.left+=R(j(n,"border-left-width")),t}function R(e){return parseFloat(e,10)||0}function V(e){return E(e)}function F(e){var t=e.getBoundingClientRect(),n=document.documentElement;return{left:t.left+(window.pageXOffset||n.scrollLeft)-(n.clientLeft||document.body.clientLeft||0),top:t.top+(window.pageYOffset||n.scrollTop)-(n.clientTop||document.body.clientTop||0)}}A.getXY=function(e,t){if(e=N(e),t=N(t),e.element!==_&&"VIEWPORT"!==e.element._id){var n=E(e.element);"fixed"!==j(n,"position")||D?(T(n,"position","absolute"),C=!1):C=!0,L(e),L(t);var a=$(n),i=t.offset(),r=e.y+a.top-(i.top+t.y),o=e.x+a.left-(i.left+t.x);return{x:o,y:r}}},A.VIEWPORT=_;var U,z,B=A,W=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",{staticClass:"panel-box",on:{dragenter:function(t){return t.stopPropagation(),t.preventDefault(),e.onDragEnter(t)},dragover:function(t){return t.stopPropagation(),t.preventDefault(),e.onDragOver(t)},dragleave:function(t){return t.stopPropagation(),t.preventDefault(),e.onDragLeave(t)}}},[n("div",{staticClass:"panel-prop-box",on:{drop:function(t){return t.stopPropagation(),t.preventDefault(),e.onColDrop(t)}}},[n("span",{staticClass:"panel-field-label"},[n("svg-icon",{attrs:{"icon-class":"layout-column-line","class-name":"field-icon"}}),e._v("行 ")],1),n("el-scrollbar",{staticClass:"field-scrollbar"},e._l(e.dimensions,(function(t){return n("el-tag",{key:t.alias,staticStyle:{margin:"0 2px"},attrs:{closable:"",effect:"dark",size:"small"},on:{close:function(n){return e.onColDelete(t)}}},[e._v(e._s(t.alias))])})),1)],1),n("div",{staticClass:"panel-prop-box",staticStyle:{"margin-top":"5px"},on:{drop:function(t){return t.stopPropagation(),t.preventDefault(),e.onRowDrop(t)}}},[n("span",{staticClass:"panel-field-label"},[n("svg-icon",{attrs:{"icon-class":"layout-row-line","class-name":"field-icon"}}),e._v("列 ")],1),n("el-scrollbar",{staticClass:"field-scrollbar"},e._l(e.measures,(function(t){return n("el-tag",{key:t.alias,staticStyle:{margin:"0 2px"},attrs:{closable:"",type:"success",effect:"dark",size:"small"},on:{close:function(n){return e.onRowDelete(t)}}},[e._v(e._s(t.alias))])})),1)],1)])},J=[];n("c740"),n("a434");(function(e){e["Dimension"]="Dimension",e["Measure"]="Measure"})(U||(U={})),function(e){e["Only"]="only",e["Union"]="union"}(z||(z={}));var G,Y=n("d4ec"),X=function e(t,n,a){Object(Y["a"])(this,e),this.dataSourceId=t,this.type=U.Dimension,this.name=n,this.alias=a},H=function e(t,n,a){Object(Y["a"])(this,e),this.dataSourceId=t,this.type=U.Measure,this.name=n,this.alias=a},K={props:{binding:{type:Object,default:function(){return null}}},data:function(){return{dataSourceId:null,dimensions:[],measures:[]}},methods:{onColDrop:function(e){var t=e.dataTransfer.getData("bindingField");if(t){var n=JSON.parse(t);this.dataSourceId&&this.dataSourceId!==n.dataSourceId?this.$message({message:"一个图表仅能绑定一个数据源表,可创建关联数据表进行跨表绑定",type:"warning"}):(this.dataSourceId=n.dataSourceId,this.dimensions.push(new X(n.dataSourceId,n.name,n.label)))}},onColDelete:function(e){var t,n=e.name,a=null===(t=this.dimensions)||void 0===t?void 0:t.findIndex((function(e){return e.name===n}));a<0||this.dimensions.splice(a,1)},onRowDrop:function(e){var t=e.dataTransfer.getData("bindingField");if(t){var n=JSON.parse(t);this.dataSourceId&&this.dataSourceId!==n.dataSourceId?this.$message({message:"一个图表仅能绑定一个数据源表,可创建关联数据表进行跨表绑定",type:"warning"}):(this.dataSourceId=n.dataSourceId,this.measures.push(new H(n.dataSourceId,n.name,n.label)))}},onRowDelete:function(e){var t,n=e.name,a=null===(t=this.measures)||void 0===t?void 0:t.findIndex((function(e){return e.name===n}));a<0||this.measures.splice(a,1)},onDragEnter:function(e){},onDragOver:function(e){},onDragLeave:function(e){},getBindingData:function(){return{dataSourceId:this.dataSourceId,dimensions:this.dimensions||[],measures:this.measures||[]}}},watch:{dimensions:function(e,t){this.$emit("change",this.getBindingData())},measures:function(e,t){this.$emit("change",this.getBindingData())},binding:function(e,t){e!==t&&(this.dataSourceId=null===e||void 0===e?void 0:e.dataSourceId,this.dimensions=(null===e||void 0===e?void 0:e.dimensions)||[],this.measures=(null===e||void 0===e?void 0:e.measures)||[])}}},q=K,Q=(n("5444"),n("2877")),Z=Object(Q["a"])(q,W,J,!1,null,"6d2f8168",null),ee=Z.exports,te=n("37c9"),ne=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{width:"100%",height:"100%"}},[n("v-chart",{ref:"chart",attrs:{options:e.chartOptions}})],1)},ae=[],ie={props:{options:{type:Object,default:function(){return null}}},data:function(){for(var e=[],t=0;t<=360;t++){var n=t/180*Math.PI,a=Math.sin(2*n)*Math.cos(2*n);e.push([a,t])}return{chartOptions:{title:{text:"线性图表"},legend:{data:["line"]},xAxis:{type:"category",data:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"]},yAxis:{type:"value"},series:[{data:[150,230,224,218,135,147,260],type:"line"}]}}},methods:{getChart:function(){return this.$refs.chart}},watch:{options:{deep:!0,handler:function(e,t){Object.assign(this.chartOptions,e||{})}}}},re=ie,oe=Object(Q["a"])(re,ne,ae,!1,null,"332a7ada",null),se=oe.exports,le={components:{SvgGrid:p.a,BindingPanel:ee,DynEchart:se},props:{pageView:{type:Object,default:function(){}},id:{type:[String,Number],default:Date.now().toString()}},data:function(){return this.pageId=this.id,this.savePageDebounce=m(340,this.savePageView),this.activeEleDebounce=m(340,this.activeEle),{pageComponents:[],selectedEleId:null,layoutScale:1}},created:function(){var e,t;this.pageComponents=null===(e=this.pageView)||void 0===e?void 0:e.components,this.selectedEleId=null===(t=this.pageView)||void 0===t?void 0:t.selectedEleId},computed:Object(o["a"])({},Object(v["mapGetters"])("board",{activeElement:"activeElement"})),methods:Object(o["a"])(Object(o["a"])({},Object(v["mapActions"])("board",["activeEle","addElement","setBinding"])),{},{onBindingChange:function(e){var t,n;this.setBinding(e);var a=null===(t=this.activeElement)||void 0===t||null===(n=t.attrs)||void 0===n?void 0:n.options;if(a){var i,r=null===(i=e.dataSourceId)||void 0===i?void 0:i.split("/"),s=e.dimensions.length>0?e.dimensions[0]:null;if(s){var l=te["a"].getFieldData(r[0],r[1],s.name);a.xAxis.data=l}for(var c=0;c<(null===(u=e.measures)||void 0===u?void 0:u.length);c++){var u,f=e.measures[c],p=te["a"].getFieldData(r[0],r[1],f.name),h=a.series.length>c?a.series[c]:null;if(h)h.data=p;else{var v=a.series.length>0?a.series[a.series.length-1]:{type:"line"},g=(v.data,Object(d["a"])(v,["data"]));a.series.push(Object(o["a"])(Object(o["a"])({},g),{},{data:p}))}}e.measures.length<=0&&(a.series=[])}},savePageView:function(e){S(this.pageId,e||[])},AssembleFormData:function(){this.formData={fields:Object(h["a"])(this.pageComponents)}},run:function(){this.dialogVisible=!0,this.showFileName=!1,this.AssembleFormData(),this.drawerVisible=!0},empty:function(){var e=this;this.$confirm("确定要清空所有组件吗？","提示",{type:"warning"}).then((function(){e.pageComponents=[],e.idGlobal=100}))},onShowPageMenu:function(e){},onShowEleMenu:function(e,t){},onEleActivated:function(e){this.activeEleDebounce(null===e||void 0===e?void 0:e.eleId)},onEleDeactivated:function(e){},onDrop:function(e){var t=e.dataTransfer.getData("componentInfo");if(t){var n=JSON.parse(t);this.clientX=e.x||e.clientX,this.clientY=e.y||e.clientY;var a=this.$refs.pageCanvas,i=B.getXY({element:a,x:0,y:0});n.layout.x=this.clientX-i.x,n.layout.y=this.clientY-i.y,this.addElement(n),this.activeEleDebounce(null===n||void 0===n?void 0:n.eleId)}},onDragEnter:function(e){},onDragOver:function(e){},onDragLeave:function(e){}})},ce=le,ue=(n("1166"),n("e6d8"),Object(Q["a"])(ce,c,u,!1,null,"fb401dd4",null)),de=ue.exports,fe={name:"AppMain",components:{PageBoard:de},computed:Object(o["a"])({},Object(v["mapGetters"])("board",{pageList:"pageList",activePageId:"activePageId"})),methods:{switchPage:function(e){return this.activePageId===e.id}}},pe=fe,he=(n("3c35c"),n("baf4"),Object(Q["a"])(pe,s,l,!1,null,"1e3cf38e",null)),ve=he.exports,ge=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tags-view-container",attrs:{id:"tags-view-container"}},[n("scroll-pane",{ref:"scrollPane",staticClass:"tags-view-wrapper",on:{scroll:e.handleScroll}},[n("el-tabs",{attrs:{type:"card"},on:{"tab-remove":e.closeSelectedTag,"tab-click":function(t){return e.onTagSelected(t)}},nativeOn:{contextmenu:function(t){return t.preventDefault(),e.openMenu(t)}},model:{value:e.selectTagId,callback:function(t){e.selectTagId=t},expression:"selectTagId"}},[e._l(e.pageList,(function(t){return n("el-tab-pane",{key:t.id,attrs:{name:t.id,label:t.title,closable:!t.affix}},[n("span",{attrs:{slot:"label"},slot:"label"},[n("i",{class:e.getTabIconClass(t)}),e._v(" "+e._s(t.title)+" ")])])})),n("el-tab-pane",{key:"pageAdd",attrs:{name:"pageAdd"}},[n("i",{staticClass:"el-icon-document-add",staticStyle:{"font-size":"24px"},attrs:{slot:"label"},slot:"label"})])],2)],1),n("ul",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],staticClass:"contextmenu",style:{left:e.left+"px",top:e.top+"px"}},[e._v(" (有待实现) "),n("li",{staticClass:"el-icon-lock",on:{click:function(t){return e.affixTag(e.selectedTag)}}},[e._v("锁定")]),n("li",{staticClass:"el-icon-refresh",on:{click:function(t){return e.refreshSelectedTag(e.selectedTag)}}},[e._v("刷新")]),e.isAffix(e.selectedTag)?e._e():n("li",{staticClass:"el-icon-close",on:{click:function(t){return e.closeSelectedTag(e.selectedTag.id)}}},[e._v("关闭")]),n("li",{staticClass:"el-icon-close",on:{click:e.closeOthersTags}},[e._v("关闭其他")]),n("li",{staticClass:"el-icon-close",on:{click:function(t){return e.closeAllTags(e.selectedTag)}}},[e._v("关闭所有")])])],1)},me=[],be=(n("7db0"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-scrollbar",{ref:"scrollContainer",staticClass:"scroll-container",attrs:{vertical:!1},nativeOn:{wheel:function(t){return t.preventDefault(),e.handleScroll(t)}}},[e._t("default")],2)}),ye=[],xe=4,Se={name:"ScrollPane",data:function(){return{left:0}},computed:{scrollWrapper:function(){return this.$refs.scrollContainer.$refs.wrap}},mounted:function(){this.scrollWrapper.addEventListener("scroll",this.emitScroll,!0)},beforeDestroy:function(){this.scrollWrapper.removeEventListener("scroll",this.emitScroll)},methods:{handleScroll:function(e){var t=e.wheelDelta||40*-e.deltaY,n=this.scrollWrapper;n.scrollLeft=n.scrollLeft+t/4},emitScroll:function(){this.$emit("scroll")},moveToTarget:function(e){var t=this.$refs.scrollContainer.$el,n=t.offsetWidth,a=this.scrollWrapper,i=this.$parent.$refs.tag,r=null,o=null;if(i.length>0&&(r=i[0],o=i[i.length-1]),r===e)a.scrollLeft=0;else if(o===e)a.scrollLeft=a.scrollWidth-n;else{var s=i.findIndex((function(t){return t===e})),l=i[s-1],c=i[s+1],u=c.$el.offsetLeft+c.$el.offsetWidth+xe,d=l.$el.offsetLeft-xe;u>a.scrollLeft+n?a.scrollLeft=u-n:d<a.scrollLeft&&(a.scrollLeft=d)}}}},we=Se,Oe=(n("bc09"),Object(Q["a"])(we,be,ye,!1,null,"4a0acffe",null)),_e=Oe.exports,Ce={components:{ScrollPane:_e},data:function(){return{visible:!1,top:0,left:0,selectTagId:null,selectedTag:{},affixTags:[]}},computed:Object(o["a"])({},Object(v["mapGetters"])("board",{pageList:"pageList",activePageId:"activePageId"})),watch:{visible:function(e){e?document.body.addEventListener("click",this.closeMenu):document.body.removeEventListener("click",this.closeMenu)},activePageId:function(e,t){var n;e!==t&&(this.selectTagId=e,this.selectTag=(null===(n=this.pageList)||void 0===n?void 0:n.find((function(t){return t.id===e})))||{})}},methods:Object(o["a"])(Object(o["a"])({},Object(v["mapActions"])("board",["activePage","addNewPage","deletePage"])),{},{onTagSelected:function(e){"pageAdd"===e.name?this.addNewPage():(this.activePage(e.name),this.selectTagId=e.name)},getTabIconClass:function(e){return e.affix?"el-icon-lock":"el-icon-document"},isActive:function(e){return this.activePageId===e},isAffix:function(e){return e.affix},affixTag:function(e){e.affix=!0},moveToCurrentTag:function(){},refreshSelectedTag:function(e){},closeSelectedTag:function(e){var t,n=null===(t=this.pageList)||void 0===t?void 0:t.find((function(t){return t.id===e}));n&&!n.affix&&this.deletePage(e)},closeOthersTags:function(){},closeAllTags:function(e){},toLastView:function(e,t){},openMenu:function(e){var t=105,n=this.$el.getBoundingClientRect().left,a=this.$el.offsetWidth,i=a-t,r=e.clientX-n+15;this.left=r>i?i:r,this.top=30,this.visible=!0},closeMenu:function(){this.visible=!1},handleScroll:function(){this.closeMenu()}})},Ie=Ce,De=(n("e4be"),n("5ae0"),Object(Q["a"])(Ie,ge,me,!1,null,"1e63cc73",null)),Ee=De.exports,je=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",{staticClass:"comp-store-container"},[n("el-input",{staticClass:"comp-store-search",attrs:{"prefix-icon":"el-icon-search",placeholder:"搜索组件(暂未实现)",clearable:""},model:{value:e.searchText,callback:function(t){e.searchText=t},expression:"searchText"}}),n("el-scrollbar",{staticClass:"center-scrollbar"},[n("el-menu",{ref:"elMenu",staticClass:"comp-store-menu",attrs:{"default-active":"'0'","default-openeds":["0"],"background-color":""}},e._l(e.componentStore,(function(t,a){return n("el-submenu",{key:t.name||e.index,attrs:{index:String(a)}},[n("template",{slot:"title"},[n("span",{staticClass:"cs-submenu-title"},[e._v(e._s(t.title))])]),n("el-scrollbar",{staticClass:"left-scrollbar"},e._l(t.children,(function(t,a){return n("div",{key:t.name&&t.name.replace(/-/g,"")+a,staticClass:"components-item",attrs:{draggable:"true"},on:{click:function(n){return e.addComponent(n,t)},dragstart:function(n){return e.onDragStart(n,t)}}},[n("div",{staticClass:"components-body"},[n("svg-icon",{attrs:{"icon-class":t.icon}}),e._v(" "+e._s(t.label)+" ")],1)])})),0)],2)})),1)],1)],1)},Te=[],ke=(n("13d5"),[{name:"chartGroup",title:"百度ECharts",children:[{name:"v-chart",label:"线性图表",value:null,icon:"chart",layout:{x:0},props:{},attrs:{autoresize:!0,options:{title:{text:"线性图表"},legend:{data:["line"]},xAxis:{type:"category",data:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"]},yAxis:{type:"value"},series:[{data:[150,230,224,218,135,147,260],type:"line"}]}}},{name:"v-chart",label:"柱状图表",value:null,icon:"chart",layout:{x:0},props:{},attrs:{autoresize:!0,options:{title:{text:"柱状图表"},xAxis:{type:"category",data:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"]},yAxis:{type:"value"},series:[{data:[120,200,150,80,70,110,130],type:"bar"}]}}}]},{name:"dataVGroup",title:"阿里DataV",children:[{name:"el-select",label:"下拉选择",icon:"select",doc:"https://element.eleme.cn/#/zh-CN/component/select",type:"",props:{span:24,required:!0,regList:[],changeTag:!0,placeholder:"请选择",style:{width:"100%"},clearable:!0,disabled:!1,filterable:!1,multiple:!1},__slot__:{options:[{label:"选项一",value:1},{label:"选项二",value:2}]}}]},{name:"3DGroup",title:"3D组件库",children:[]}]),Pe={name:"CompStore",components:{},data:function(){return this.componentStore=ke,{searchText:null}},created:function(){},computed:Object(o["a"])({},Object(v["mapGetters"])("board",{activePageId:"activePageId"})),methods:Object(o["a"])(Object(o["a"])({},Object(v["mapActions"])("board",["setActivePage","addElement"])),{},{setObjectValueByStringKeys:function(e,t,n){var a=t.split(".");a.reduce((function(e,t,i){return a.length===i+1?e[t]=n:"[Object Object]"!==Object.prototype.toString.call(e[t])&&(e[t]={}),e[t]}),e)},setRespData:function(e,t){var n=null===e||void 0===e?void 0:e.load,a=n.dataPath,i=n.dataConsumer;if(a&&i){var r=a.split(".").reduce((function(e,t){return e[t]}),t);this.setObjectValueByStringKeys(e,i,r)}},fetchComponent:function(e){var t=this,n=e.load,a=n.method,i=n.url;a&&i&&(this.setLoading(e,!0),this.$http[a]({url:i}).then((function(n){t.setLoading(e,!1),t.setRespData(e,n.data),e.load.status="loaded"})).catch((function(e){})))},setLoading:function(e,t){var n=e.directives;if(Array.isArray(n)){var a=n.find((function(e){return"loading"===e.name}));a&&(a.value=t)}},onDragStart:function(e,t){t&&this.addComponent(e,t)},addComponent:function(e,t){t.load&&"loaded"!=t.load.status&&this.fetchComponent(t);var n=this.generateElement(t);e&&(e.dataTransfer.effectAllowed="move",n.dataSource={sourceId:null,measures:[],dismensions:[]},e.dataTransfer.setData("componentInfo",JSON.stringify(n)))},generateElement:function(e){var t={};return Object.assign(t,e),t.active=!0,t.props=t.props||{},t.layout=t.layout||{},t.layout.type=t.layout.type||"",t.layout.x=t.layout.x||0,t.layout.y=t.layout.y||0,t.layout.w=t.layout.w||"auto",t.layout.h=t.layout.h||"auto",t.eleId=Object(h["b"])(),t}})},Ae=Pe,Ne=(n("c77f"),Object(Q["a"])(Ae,je,Te,!1,null,"2ee6e8c6",null)),Le=Ne.exports,Me=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},$e=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h1",[e._v("属性侧边栏")])])}],Re={data:function(){return{}}},Ve=Re,Fe=Object(Q["a"])(Ve,Me,$e,!1,null,"180e98c7",null),Ue=Fe.exports,ze=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"data-source-container"},[n("split-pane",{attrs:{split:"horizontal","default-percent":35}},[n("template",{slot:"paneL"},[n("div",{staticStyle:{width:"100%","border-bottom":"1px solid gray",height:"30px"}},[n("span",{staticStyle:{"padding-left":"10px"}},[e._v("数据源")]),n("span",{staticClass:"data-source-add",on:{click:e.onCreateUnion}},[e._v("创建关联")]),n("span",{staticClass:"data-source-add",on:{click:e.onAdd}},[e._v("添加")]),n("el-dialog",{attrs:{title:"上传Excel文件",visible:e.dialogVisible,width:"30%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[n("excel-upload",{on:{change:e.onUploadChange}}),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{size:"mini"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取消")]),n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.onUploadCommit()}}},[e._v("确定")])],1)],1)],1),n("div",{staticStyle:{"min-height":"30px",height:"auto"}},e._l(e.sourceList,(function(t){return n("div",{key:t.id,staticClass:"data-source-item",style:e.selectDSid===t.id?"background-color:#ffffff;color:#28a7f2":"",on:{click:function(n){return e.onDataSourceClick(t)}}},[n("span",{directives:[{name:"show",rawName:"v-show",value:e.selectDSid===t.id,expression:"selectDSid===item.id"}],staticStyle:{height:"100%",width:"10px","background-color":"skyblue",border:"1px solid transparent"}}),n("span",{staticStyle:{"padding-left":"5px",height:"30px"}},[e._v(e._s(t.name))])])})),0),n("div",{staticStyle:{height:"60px"}}),n("div",{staticStyle:{width:"100%","border-bottom":"1px solid gray",height:"30px"}},[n("span",{staticStyle:{"padding-left":"10px"}},[e._v("工作表")])]),n("div",e._l(e.sheetTree,(function(t){return n("div",{key:t.name,attrs:{draggable:!0},on:{dragstart:function(n){return e.onDragSheetStart(n,t)},click:function(n){return e.onSheetClick(t)}}},[e._v(e._s(t.label))])})),0)]),n("template",{slot:"paneR"},[n("div",{staticStyle:{"padding-left":"10px","border-bottom":"1px solid gray","border-top":"1px solid lightgray",height:"30px"}},[e._v("字段")]),n("div",[n("span",{staticStyle:{"margin-left":"20px"}},[e._v("维度")]),n("el-input",{staticStyle:{"margin-top":"2px",display:"inline-block"},attrs:{placeholder:"输入关键字进行过滤"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),n("div",{staticStyle:{"margin-left":"30px"}},e._l(e.dimensions,(function(t){return n("div",{key:t.name,attrs:{draggable:!0},on:{dragstart:function(n){return e.onDragStart(n,t)}}},[e._v(e._s(t.label))])})),0)],1),n("el-divider"),n("div",[n("span",{staticStyle:{"margin-left":"20px"}},[e._v("度量")]),n("el-input",{staticStyle:{"margin-top":"2px",display:"inline-block"},attrs:{placeholder:"输入关键字进行过滤"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),n("div",{staticStyle:{"margin-left":"30px"}},e._l(e.measures,(function(t){return n("div",{key:t.name,attrs:{draggable:!0},on:{dragstart:function(n){return e.onDragStart(n,t)}}},[e._v(e._s(t.label))])})),0)],1)],1)],2)],1)},Be=[],We=(n("d81d"),n("99af"),n("4de4"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",[n("el-upload",{ref:"upload",attrs:{action:e.actionUrl,"list-type":e.listType,"auto-upload":!1,"before-upload":e.onBeforeUpload,"on-change":e.onFileChange,"on-success":e.onUploadSuccess,"on-exceed":e.onFileExceed,"on-error":e.onError,accept:e.accept,"file-list":e.fileList,"with-credentials":!0,multiple:e.multiple,limit:e.limitCount}},[n("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("选取文件")]),n("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(" 只能上传"+e._s(e.accept)+"文件，单个文件不超过"+e._s(e.limitSizeText)+" "),e.multiple?n("div",{staticStyle:{"margin-top":"5px"}},[e._v("单次上传不可超过剩余可上传数量")]):e._e()])],1),e.errorMessage?n("div",{staticStyle:{"margin-top":"5px"}},[e._v(" 错误信息: "),n("el-input",{staticStyle:{"max-height":"500px","user-select":"text"},attrs:{autosize:{minRows:2,maxRows:6},value:e.errorMessage,type:"textarea",readonly:""}})],1):e._e()],1)}),Je=[],Ge=(n("0481"),{props:{uploadUrl:{type:String,default:""},multiple:{type:Boolean,default:!1},accept:{type:String,default:".xlsx, .xls"},listType:{type:String,default:"text"},limitSize:{type:Number,default:5242880},limitCount:{type:[Number,null],default:null}},data:function(){return{actionUrl:this.uploadUrl,disabledAdd:!1,fileList:[],showDialog:!1,errorMessage:null,uploadParams:{}}},mounted:function(){var e;this.addParentEle=null===(e=this.$refs.uploadPlus)||void 0===e?void 0:e.parentElement},computed:{limitSizeText:function(){var e=this.limitSize/1024;return e<1024?e+"kb":e/1024+"M"}},methods:{onFileExceed:function(e,t){},onFileChange:function(e,t){var n;(this.fileList=t,this.limitCount)&&(this.disabledAdd=(null===(n=this.fileList)||void 0===n?void 0:n.length)>=this.limitCount);this.$emit("change",t)},onFileReomve:function(e,t){var n,a,i=this.fileList.indexOf(e);(null===(n=this.fileList)||void 0===n||n.splice(i,1),this.limitCount)&&(this.disabledAdd=(null===(a=this.fileList)||void 0===a?void 0:a.length)>=this.limitCount)},onError:function(e,t,n){this.errorMessage="string"===typeof e?e:null===e||void 0===e?void 0:e.message},onBeforeUpload:function(e){var t=e.size/1024/1024<this.limitSize;return t||(this.errorMessage="上传文件大小不能超过 5MB!"),t},onUploadSuccess:function(e,t){var n;this.$emit("submit",null===(n=this.fileList)||void 0===n?void 0:n.map((function(e){var t;return null===(t=e.response)||void 0===t?void 0:t.result})).flat())},submit:function(){var e;null===(e=this.$refs.upload)||void 0===e||e.submit()}},watch:{disabledAdd:function(e,t){e!==t&&this.addParentEle&&(this.addParentEle.style.display=e?"none":"inline-block")}}}),Ye=Ge,Xe=Object(Q["a"])(Ye,We,Je,!1,null,"7a2d1b8c",null),He=Xe.exports,Ke=n("131e"),qe=n.n(Ke),Qe={readFileAsync:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){var a,i,r,s,l;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=e.raw,i=Object(d["a"])(e,["raw"]),n.next=3,t._readFileAsync(a);case 3:return r=n.sent,s=qe.a.read(r,{type:"binary"}),l=Object(o["a"])(Object(o["a"])({},i),{},{sheets:[],type:z.Only}),s.SheetNames.forEach((function(e){var n=s.Sheets[e];l.sheets.push({name:e,header:t._getRowHeader(n),data:qe.a.utils.sheet_to_json(n)})})),n.abrupt("return",l);case 8:case"end":return n.stop()}}),n)})))()},_readFileAsync:function(e){return new Promise((function(t,n){var a=new FileReader;a.onload=function(e){var n;t(null===e||void 0===e||null===(n=e.target)||void 0===n?void 0:n.result)},a.onerror=function(e){n(e)},a.onabort=function(e){n(new Error("读取文件被终止"))},a.readAsBinaryString(e)}))},_getRowHeader:function(e){var t,n=[],a=qe.a.utils.decode_range(e["!ref"]),i=a.s.r;for(t=a.s.c;t<=a.e.c;++t){var r=e[qe.a.utils.encode_cell({c:t,r:i})],o="UNKNOWN "+t;r&&r.t&&(o=qe.a.utils.format_cell(r)),n.push(o)}return n}},Ze=n("bee2"),et=(n("caad"),n("2532"),{setItem:function(e,t,n){var a={value:t,time:Date.now(),expires:n};window.localStorage.setItem(e,JSON.stringify(a))},getItem:function(e){var t=window.localStorage.getItem(e);if(!t)return t;var n=JSON.parse(t);return n.expires&&Date.now()-n.time>n.expires?(window.localStorage.removeItem(e),null):n.value},removeItem:function(e){window.localStorage.removeItem(e)}});(function(e){e["cookie"]="cookie",e["disk"]="disk",e["indexDB"]="indexDB",e["localStorage"]="localStorage",e["sessionStorage"]="sessionStorage"})(G||(G={}));var tt="bi-cache-list",nt=function(){function e(){Object(Y["a"])(this,e)}return Object(Ze["a"])(e,[{key:"getAllCache",value:function(){var e=et.getItem(tt);return e?JSON.parse(e):null}},{key:"cachesAppend",value:function(e){var t=this.getCache(tt);t=t||[],t.includes(e)||t.push(e),this.setCache(tt,t)}},{key:"getCache",value:function(e,t){var n=et.getItem(e);return n?JSON.parse(n):null}},{key:"setCache",value:function(e,t,n){et.setItem(e,JSON.stringify(t||{}))}},{key:"deleteCache",value:function(e){et.removeItem(e)}}]),e}(),at=new nt,it={components:{ExcelUpload:He},data:function(){return this.uploadFileList=null,{selectDSid:null,selectSheet:null,dialogVisible:!1,filterText:null,dataSources:[],measures:[],dimensions:[]}},computed:{sourceList:function(){var e;return null===(e=this.dataSources)||void 0===e?void 0:e.map((function(e){return{id:e.id,name:e.name}}))},sheetTree:function(){var e,t=this,n=this.dataSources.find((function(e){return e.id===t.selectDSid})),a=[];return null===n||void 0===n||null===(e=n.sheets)||void 0===e||e.forEach((function(e){a.push({dsId:n.id,dsName:n.name,name:e.name,label:e.name})})),a}},created:function(){this.initDataSources()},methods:Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(v["mapActions"])("data-source",["setDataSources"])),Object(v["mapActions"])("settings",["changeSettings"])),{},{initDataSources:function(){var e=this,t=at.getAllCache();null===t||void 0===t||t.forEach((function(t){var n=at.getCache(t);n&&e.dataSources.push(n)})),this.setDataSources(this.dataSources)},onDataSourceClick:function(e){this.selectDSid=e.id},onSheetClick:function(e){var t=this;this.selectSheet=e;var n=this.dataSources.find((function(e){return e.id===t.selectDSid}));if(n){var a=n.sheets.find((function(e){return e.name===t.selectSheet.name}));this.dimensions=a.header.map((function(e){var n;return{dataSourceId:"".concat(t.selectDSid,"/").concat(null===(n=t.selectSheet)||void 0===n?void 0:n.name),name:e,label:e}}))}},onDragSheetStart:function(e,t){e&&(e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("dataSourceSheet",JSON.stringify(t||{})))},onDragStart:function(e,t){if(e){e.dataTransfer.effectAllowed="move";var n={};Object.assign(n,t),e.dataTransfer.setData("bindingField",JSON.stringify(n))}},filterNode:function(e,t){return!e||-1!==t.label.indexOf(e)},getActiveStyle:function(e){return e.actived?"margin:1px 0 1px 5px":""},onAdd:function(){this.dialogVisible=!0},onUploadChange:function(e){this.uploadFileList=e},onUploadCommit:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var n,a,i,r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,!((null===(n=e.uploadFileList)||void 0===n?void 0:n.length)<=0)){t.next=3;break}return t.abrupt("return");case 3:a=0;case 4:if(!(a<e.uploadFileList.length)){t.next=18;break}return i=e.uploadFileList[a],t.next=8,Qe.readFileAsync(i);case 8:r=t.sent,o=Object(h["b"])(),r.id=o,at.cachesAppend(o),at.setCache(o,r),e.dataSources.push(r),e.setDataSources(e.dataSources);case 15:a++,t.next=4;break;case 18:e.dialogVisible=!1,t.next=24;break;case 21:t.prev=21,t.t0=t["catch"](0),e.$message.error(null===t.t0||void 0===t.t0?void 0:t.t0.message);case 24:case"end":return t.stop()}}),t,null,[[0,21]])})))()},onCreateUnion:function(){this.changeSettings({dataSourceUnion:!0})}}),watch:{filterText:function(e){this.$refs.tree.filter(e)}}},rt=it,ot=(n("3a7f"),Object(Q["a"])(rt,ze,Be,!1,null,"0447c08e",null)),st=ot.exports,lt=function(){return n.e("chunk-71b8ce94").then(n.bind(null,"4155"))},ct={name:"Layout",components:{AppMain:ve,PropsSidebar:Ue,TagsView:Ee,ChartStore:Le,DataSource:st,DataSourceUnion:lt},data:function(){return{selectMenuIndex:"2"}},computed:Object(o["a"])({},Object(v["mapState"])({sidebar:function(e){return e.app.sidebar},device:function(e){return e.app.device},dsUnionVisible:function(e){return e.settings.dataSourceUnion},needTagsView:function(e){return e.settings.tagsView},fixedHeader:function(e){return e.settings.fixedHeader}})),created:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n=O(),e.setPageList(n);case 2:case"end":return t.stop()}}),t)})))()},methods:Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(v["mapActions"])("type-manifest",["initTypesManifest"])),Object(v["mapActions"])("board",["setPageList"])),{},{handleClickOutside:function(){this.$store.dispatch("app/closeSideBar",{withoutAnimation:!1})},fetchData:function(e){var t;null===(t=this.$refs.component)||void 0===t||t.fetchData(e)}})},ut=ct,dt=(n("c300"),Object(Q["a"])(ut,a,i,!1,null,"25e76dc6",null));t["default"]=dt.exports},f0e4:function(e,t,n){function a(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}n("b64b"),e.exports=a,e.exports["default"]=e.exports,e.exports.__esModule=!0},f387:function(e,t,n){}}]);